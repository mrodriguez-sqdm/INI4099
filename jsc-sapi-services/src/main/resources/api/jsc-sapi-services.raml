#%RAML 1.0
title: jsc-sapi-services
baseUri: jsc-sapi-services-{env}.us-e2.cloudhub.io/jsc
description: The following API will be in charge of the comunications towards JSC exposed services
mediaType: 
 - application/json
protocols:
  - HTTP
types:
  patch-subscription-request: !include datatypes/requests/patch-subscription-request.raml
  patch-subscription-externalId-request:  !include datatypes/requests/patch-subscription-externalId-request.raml
  patch-subscription-status-request: !include datatypes/requests/patch-subscription-status-request.raml
  patch-subscription-corp: !include datatypes/requests/patch-subscription-corp-request.raml
  post-order-request: !include datatypes/requests/post-order-request.raml
  post-order-request-subscription: !include /datatypes/requests/post-order-request-subscription.raml
  post-groupInstanceId-request : !include /datatypes/requests/post-groupInstanceId-request.raml
  post-transferbalance-request: !include /datatypes/requests/post-transferbalance-request.raml
  patch-billing-ba-id-request: !include /datatypes/requests/patch-billing-ba-id-request.raml
traits:
  security_client_id: !include exchange_modules/35a39a92-efa9-49b6-8f13-d66508fd2f35/security-clientid/1.0.2/security-clientid.raml
  

/v1:
  /transferbalance:
    post:
      is: [security_client_id]
      displayName: Create transfer balance
      description: Service to create transfer balance
      queryParameters:
        subscription:
          type: string
          required: true
          example: "SID999220_TS1730711399484_0"
      body:
        application/json:
          type: post-transferbalance-request
      responses:
        200:
          body:
            application/json:
              example: !include examples/responses/post-transferbalance-response.json
  /order:
    post:
      is: [security_client_id]
      displayName: Create Order
      description: Service to create order activation of a mobile service
      body:
        application/json:
          type: post-order-request | post-order-request-subscription
      responses:
        201:
          body:
            application/json:
              example: !include examples/responses/post-order-response.json
    /{id}:
      patch:
        is: [security_client_id]
        displayName: End order
        description: Service to end order by id
        queryParameters:
          action:
            type: string
            required: true
            example: "APPLY"
        responses:
          200:
            body:
              application/json:
                example: {}
          202:
            body:
              application/json:
                example: {}
  /subscriber:
    get:
      is: [security_client_id]
      displayName: Obtain Suscriber
      description: Service to obtain suscriber by externalID
      queryParameters:
        externalID:
          type: string
          required: true
          example: "externalID_002"
      responses:
        201:
          body:
            application/json:
              example: !include examples/responses/get-subscriber-response.json
    post:
      is: [security_client_id]
      displayName: Create Subscriber
      description: Service to create subscriber
      body:
        application/json:
          type: !include datatypes/requests/post-subscriber-request.raml
      responses:
        201:
          body:
            application/json:
              example: !include examples/responses/post-subscriber-response.json
    /{id}:
      patch:
        is: [security_client_id]
        displayName: Update Subscriber
        description: Update Subscriber
        body:
          application/json:
            type: !include datatypes/requests/update-subscriber.raml
        responses:
          202:
            body:
              application/json:
                example: {}
  /msisdn:
    post:
      is: [security_client_id]
      displayName: "Create Msisdn"
      description: "Create Msisdn in JSC"
      body:
        application/json:
          type: !include datatypes/requests/post-msisdn-request.raml
      responses:
        201:
          body:
            application/json:
              example: !include examples/responses/post-msisdn-response.json
    /{msisdn}:
      patch:
        is: [security_client_id]
        displayName: Update msisdn status
        description: Service to update msisdn status
        queryParameters:
          action:
            type: string
            required: true
            example: "MODIFY"
        body:
          application/json:
            type: !include datatypes/requests/patch-msisdn-request.raml
        responses:
          200:
            body:
              application/json:
                example: {}
      get:
        is: [security_client_id]
        displayName: Get msisdn
        description: Service to get msisdn
        responses:
          200:
            body:
              application/json:
                example: !include examples/responses/get-msisdn-response.json
      delete:
        is: [security_client_id]
        displayName: Delete msisdn
        description: Service to delete msisdn
        responses:
          200:
            body:
              application/json:
                example: !include examples/responses/deleteMSISDN.json
          404:
            body:
              application/json:
                example: !include examples/error/404error.json
          500:
            body:
              application/json:
                example: !include examples/error/500error.json          
      /{order_id}:
        patch:
          is: [security_client_id]
          displayName: Update number of orden
          description: Service to update number of orden
          responses:
            200:
              body:
                application/json:
                  example: {"id":"3336025010","links":[{"rel":"self","href":"https://pre.ioscolombia.com.co/bssrest/v1/msisdn/3336025010"}]}
  /sim:
    /{iccid}:
      get:
        is: [security_client_id]
        displayName: Get sim by id
        description: Service to get sim by id
        responses:
          200:
            body:
              application/json:
                example: !include examples/responses/get-sim-response.json
      /{order_id}:
        patch:
          is: [security_client_id]
          displayName: Update number of simcard
          description: Service to update number of simcard
          responses:
            200:
              body:
                application/json:
                  example: {"id":"8957287000000000031","links":[{"rel":"self","href":"https://pre.ioscolombia.com.co/bssrest/v1/sim/8957287000000000031"}]}
  /billing:
    /ba:
      post:
        is: [security_client_id]
        displayName: Create Billing Account
        description: Service to create Billing Account
        body:
          application/json:
            type: !include datatypes/requests/post-billing-ba-request.raml
        responses:
          201:
            body:
              application/json:
                example: !include examples/responses/post-billing-ba-response.json
      get:
        is: [security_client_id]
        displayName: Get Billing Account by External Id
        description: Get Billing Account by External Id
        queryParameters:
          externalID:
            type: string
            required: true
            example: "123456789"
        responses:
          200:
            body:
              application/json:
                example: !include examples/responses/get-billingAccount.json               
      /{id}:
        patch:
          is: [security_client_id]
          displayName: Update Subscriber by Billing Account 
          description: Service to update Subscriber by Billing Account
          body:
            application/json:
              type: patch-billing-ba-id-request
          responses:
            200:
              body:
                application/json:
                  example: !include examples/responses/patch-billing-ba-id-response.json                   
  /subscription:
    get:
      is: [security_client_id]
      displayName: Get subscriptionID by External Id or msisdn
      description: Get subscriptionID by External Id or msisdn
      queryParameters:
        externalID:
          type: string
          required: false
          example: "223201"
        msisdn:
          type: string
          required: false
          example: "msisdn"
      responses:
        200:
          body:
            application/json:
              example: !include examples/responses/get-subscription.json
    /{subscriptionID}:
      patch:
        is: [security_client_id]
        displayName: Move Billing Account or Add External Id
        description: Service to move Billing Account or add External Id
        queryParameters:
          action:
            type: string
            required: false
            example: "MODIFY"
        body:
          application/json:
            type: patch-subscription-request | patch-subscription-externalId-request | patch-subscription-status-request | patch-subscription-corp
        responses:
          201:
            body:
              application/json:
                example: {}
    /{subscription_id}:
      patch:
        is: [security_client_id]
        displayName: Move Billing Account or Add External Id
        description: Service to move Billing Account or add External Id
        queryParameters:
          action:
            type: string
            required: false
            example: "MODIFY"
        body:
          application/json:
            type: patch-subscription-request | patch-subscription-externalId-request | patch-subscription-status-request | patch-subscription-corp
        responses:
          201:
            body:
              application/json:
                example: {}
      /change-owner:
        /{subscriber_id}:
          post:
            is: [security_client_id]
            displayName:  Assing subscription to subscriber
            description: Service to change subscription owner
            body:
              application/json:
            responses:
              200:
      /features:
        get:
          is: [security_client_id]
          displayName:  Obtain data from a feature.
          description: Service to obtain data from a feature.
          responses:
              200:
                body:
                  application/json:
                    example: !include examples/responses/get-features-response.json
        patch:
          is: [security_client_id]
          displayName:  Assign info to a feature
          description: Service to assign info to a feature
          body:
            application/json:
              type: !include datatypes/requests/patch-features-request.raml
          responses:
              200:
                body:
                  application/json:
                    example: {}
    /group:
      /{SID}:
        get:
          is: [security_client_id]
          displayName: Get groupInstance ID Virtual group line
          description: Service get the information of a subscription and the groupIntanceId of a row
          responses:
            200:
              body:
                application/json:
                  example: !include examples/responses/get-sid-response.json         
  /topup:
    post:
      is: [security_client_id]
      displayName:  Recharge Phone Balance
      description: Service to recharge Phone Balance
      body:
        application/json:
          type: !include datatypes/requests/post-topup-request.raml
      responses:
        201:
          body:
            application/json:
              example: !include examples/responses/post-topup-response.json
  /pkgi:
    /{pkgi_id}:
      get:
        is: [security_client_id]
        displayName: Get Virtual SID of a packageInstanceID
        description: Service get the information of a package and the related groupMember.
        responses:
          200:
            body:
              application/json:
                example: !include examples/responses/get-pkgi_id-response.json
      patch:
        is: [security_client_id]
        displayName: Removes an SVA from a subscription
        description: Service removes an SVA from a subscription
        responses:
          200:
            body:
              application/json:
                example: {}
    get:
      queryParameters:
        SID:
          type: string
          example: "SID309676_TS1622195711649_0"
        status:
          type: string
          example: "Active"
          required: false
        packageType:
          type: string
          example: "CHANGEPKG"
          required: false
      is: [security_client_id]
      displayName: Get SVA by a subscription
      description: Service get the information of a SVA.
      responses:
        200:
          body:
            application/json:
              example: {}
                 
  /groupinstance:
    /member:
      get:
        is: [security_client_id]
        displayName: Consultar member del group
        description: Retrieve member of group.
        queryParameters:
          groupInstanceEq:
            type: string
            example: "1234"
          subscriptionEq:
            type: string
            example: "1234"        
        responses:
          200:
            body:
              application/json:
                example: {}
    /{groupInstanceId}:
      /member:
        post:
          is: [security_client_id]
          displayName: Agregar línea hija al grupo
          description: Service to allows you to add a child line to an instance of a group.
          body:
            application/json:
              type: post-groupInstanceId-request 
          responses:
            201:
              body:
                application/json:
                  example: !include examples/responses/post-groupInstanceId-response.json
        /{memberId}:
          delete:
            is: [security_client_id]
            displayName: Eliminar línea hija al grupo
            description: Service to allows you to delete a child line to an instance of a group.
            responses:
              200:
                body:
                  application/json:
                    example: {}
  /consumption:
    /{id}:
      /details:
        get:
          is: [security_client_id]
          displayName: Get Consumption Details
          description: Get Consumption details by an number of connection
          responses:
            201:
              body:
                application/json:
                  example: {}    
  /balance:
    get:
      is: [security_client_id]
      displayName: Get Consumption Structured
      description: Get Consumption Structured
      queryParameters:
        SID:
          type: string
          example: "SID309676_TS1622195711649_0"
        status:
          type: string
          example: "ACTIVE"
        size:
          type: string
          example: "100"
      responses:
        201:
          body:
            application/json:
              example: {}
  /smpp:
    /sendMessage:
      post:
        is: [security_client_id]
        displayName: Send message
        description: Service to send messages by smpp protocol.
        body:
          application/json:
            type: !include datatypes/requests/post-sendMessage-request.raml
            example: !include examples/requests/post-sendMessage-request.json
        responses:
          200:
            body:
              application/json:
                type: !include datatypes/responses/post-sendMessage-response.raml
                example: !include examples/responses/post-sendMessage-response.json