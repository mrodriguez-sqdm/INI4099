#%RAML 1.0
title: customer-papi-services
version: v1
baseUri:  http://customer-papi-services-{env}.us-e2.cloudhub.io/{version}
description: This API exposes services to manage the orchestration of customer.
protocols:
  - HTTP

traits:
  tibcoHeaders: !include exchange_module/35a39a92-efa9-49b6-8f13-d66508fd2f35/tibcorequestheaders/1.0.6/tibcorequestheaders.raml
  security_client_id: !include exchange_module/35a39a92-efa9-49b6-8f13-d66508fd2f35/security-clientid/1.0.2/security-clientid.raml


mediaType: 
  - application/json

/customer:
  get:
    is: [security_client_id,tibcoHeaders]
    displayName: getCustomer
    description: view customer 
    queryParameters:
        ORIGIN:
          type: string
          example: "WHATSAPP"
          description: Parameter that allows the origin of the request to be identified
        CUSTOMER_ID:
          type: string
          example: "12552454"
          description: Customer identification number can be ID card or tax ID number
          required: false
        CUSTOMER_ID_TYPE:
          type: string
          enum: ["CC","CE","PASAPORTE","NIT","RUT","TI"]
          example: "CC"
          description: Type of customer identification document
          required: false
        FILTERS:
          type: string
          example: "Phone:542545454;AccountNumber:12452145"
          description: String used to apply filters to the query (follow example), separate the filter type and its value with a colon, and separate the number of filters with a semicolon.
          required: false
        LIMIT:
          type: number
          description: Limit on orders to display
          required: false
        OFFSET:
          type: string
          description: used to organize information and establish a logical order
          required: false
    responses:
          200:
            body:
              application/json:
                type: !include /datatypes/response/get-customer.raml
                examples: 
                  byDocument:
                    value: !include /examples/response/get-customer-by-documentid.json
                  byPhone:
                    value: !include /examples/response/get-customer-by-phone.json
          400:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-400.json
          401:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-401.json
          404:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-404.json
          500:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-500.json
  post:
    is: [security_client_id,tibcoHeaders]
    displayName: create Customer
    description: create Customer
    queryParameters:
        BUSINESS:
          type: string
          example: "MDM"
          description: Parameter that defines the data source on which the operation will be executed.
    body:
        application/json:
          type: !include /datatypes/request/customer.raml
          example: !include /examples/request/customer.json
    responses:
          200:
            body:
              application/json:
                type: !include /datatypes/response/customer.raml
                example: !include /examples/response/customer.json
          400:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-400.json
          401:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-401.json
          404:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-404.json
          500:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-500.json

  patch:
      is: [security_client_id,tibcoHeaders]
      displayName: update Customer
      description: update Customer
      queryParameters:
          BUSINESS:
            type: string
            example: "MDM"
            description: Parameter that defines the data source on which the operation will be executed.  
      body:
          application/json:
            type: !include /datatypes/request/customer.raml
            example: !include /examples/request/customer.json
      responses:
          200:
            body:
              application/json:
                type: !include /datatypes/response/customer.raml
                example: !include /examples/response/customer.json
          400:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-400.json
          401:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-401.json
          404:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-404.json
          500:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-500.json
  /authorizationTdp:
    post:
      is: [security_client_id,tibcoHeaders]
      displayName: Authorization TDP
      description: Updates the personal data processing decision for a Salesforce customer; receives customer data and returns results.
      queryParameters:
        ORIGIN:
          type: string
          example: "WHATSAPP"
          description: Parameter that allows the origin of the request to be identified
      body:
          application/json:
            type: !include /datatypes/request/authorization-tdp.raml
            example: !include /examples/request/authorization-tdp.json
      responses:
            200:
              body:
                application/json:
                  type: !include /datatypes/response/authorization-tdp.raml
                  example: !include /examples/response/authorization-tdp.json
            400:
              body:
                application/json:
                  type: !include /datatypes/response/error.raml
                  example: !include /examples/response/error-400.json
            401:
              body:
                application/json:
                  type: !include /datatypes/response/error.raml
                  example: !include /examples/response/error-401.json
            404:
              body:
                application/json:
                  type: !include /datatypes/response/error.raml
                  example: !include /examples/response/error-404.json
            500:
              body:
                application/json:
                  type: !include /datatypes/response/error.raml
                  example: !include /examples/response/error-500.json
/productOrder:
    get:
      is: [security_client_id,tibcoHeaders]
      displayName: productOrder
      description: view product orders
      queryParameters:
        ORIGIN:
          type: string
          example: "WHATSAPP"
          description: Parameter that allows the origin of the request to be identified
        ORDER_NUMBER:
          type: string
          example: "MDM"
          description: "Order number"
          required: false
        FILTERS:
          type: string
          example: "Phone:245212454;AccountNumber:12452145"
          description: String used to apply filters to the query (follow example), separate the filter type and its value with a colon, and separate the number of filters with a semicolon.
          required: false
        LIMIT:
          type: number
          description: Limit on orders to display
          required: false
        OFFSET:
          type: string
          description: used to organize information and establish a logical order
          required: false
      responses:
          200:
            body:
              application/json:
                type: !include /datatypes/response/get-productOrder.raml
                example: !include /examples/response/get-productOrder.json
          400:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-400.json
          401:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-401.json
          404:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-404.json
          500:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-500.json
/customerBill:
  get:
    is: [security_client_id,tibcoHeaders]
    displayName: getCustomerBilling
    description: view customer billing
    queryParameters:
        ORIGIN:
          type: string
          example: "WHATSAPP"
          description: Parameter that allows the origin of the request to be identified
        BILLING_NUMBER:
          type: string
          example: "12552454"
          description: Number billing
          required: false
        FILTERS:
          type: string
          example: "Barcode:542545454;Phone:12452145;BillingAccount:656565;DocumentNumber:72727277;DocumentType:CC;"
          description: String used to apply filters to the query (follow example), separate the filter type and its value with a colon, and separate the number of filters with a semicolon.
          required: false
        NOTIFICATION_METHOD:
          type: string
          description: method of notification of clearance certificate
          example: "Email, Phone or whatsapp"
          required: false
        NOTIFICATION_VALUE:
          type: string
          description: Value of the notification method. Phone number or WhatsApp according to the selected notification method.
          example: "1234567891"
          required: false
        LIMIT:
          type: number
          description: Limit on orders to display
          required: false
        OFFSET:
          type: string
          description: used to organize information and establish a logical order
          required: false
    responses:
          200:
            body:
              application/json:
                type: !include /datatypes/response/get-customerBill.raml
                example: !include /examples/response/get-customerBill.json
          400:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-400.json
          401:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-401.json
          404:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-404.json
          500:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-500.json
  /balance:
    get:
      is: [security_client_id,tibcoHeaders]
      displayName: getCustomerBilling
      description: view customer billing
      queryParameters:
          ORIGIN:
            type: string
            example: "WHATSAPP"
            description: Parameter that allows the origin of the request to be identified
          CUSTOMER_ID:
            type: string
            example: "12552454"
            description: Customer identification number can be ID card or tax ID number
            required: false
          CUSTOMER_ID_TYPE:
            type: string
            enum: ["CC","CE","PASAPORTE","NIT","RUT","TI"]
            example: "CC"
            description: Type of customer identification document
            required: false
          BILLING_ACCOUNT:
            type: string
            description: User billing account to retrieve balances
            required: false
          CONNECTION_NUMBER:
            type: number
            description: User phone number
            required: false
      responses:
            200:
              body:
                application/json:
                  type: !include /datatypes/response/get-balance.raml
                  example: !include /examples/response/get-balance.json
            400:
              body:
                application/json:
                  type: !include /datatypes/response/error.raml
                  example: !include /examples/response/error-400.json
            401:
              body:
                application/json:
                  type: !include /datatypes/response/error.raml
                  example: !include /examples/response/error-401.json
            404:
              body:
                application/json:
                  type: !include /datatypes/response/error.raml
                  example: !include /examples/response/error-404.json
            500:
              body:
                application/json:
                  type: !include /datatypes/response/error.raml
                  example: !include /examples/response/error-500.json
  /clearance:
      get:
        is: [security_client_id,tibcoHeaders]
        displayName: Paz y Salvo
        description: Genera y envía el certificado de paz y salvo (sin deuda) de un cliente; recibe datos de cliente y retorna documento o link.
        queryParameters:
            ORIGIN:
              type: string
              example: "WHATSAPP"
              description: Parameter that allows the origin of the request to be identified
            CUSTOMER_ID:
              type: string
              example: "12552454"
              description: Customer identification number can be ID card or tax ID number
              required: false
            CUSTOMER_ID_TYPE:
              type: string
              enum: ["CC","CE","PASAPORTE","NIT","RUT","TI"]
              example: "CC"
              description: Type of customer identification document
              required: false
            BILLING_ACCOUNT:
              type: string
              description: User billing account to retrieve balances
              required: false
            CONNECTION_NUMBER:
              type: number
              description: User phone number
              required: false
            NOTIFICATION_METHOD:
              type: string
              description: method of notification of clearance certificate
              example: "Email, Phone or whatsapp"
              required: false
            NOTIFICATION_VALUE:
              type: string
              description: Value of the notification method. Phone number or WhatsApp according to the selected notification method.
              example: "1234567891"
              required: false
        responses:
              200:
                body:
                  application/json:
                    type: !include /datatypes/response/get-clearance.raml
                    example: !include /examples/response/get-clearance.json
              400:
                body:
                  application/json:
                    type: !include /datatypes/response/error.raml
                    example: !include /examples/response/error-400.json
              401:
                body:
                  application/json:
                    type: !include /datatypes/response/error.raml
                    example: !include /examples/response/error-401.json
              404:
                body:
                  application/json:
                    type: !include /datatypes/response/error.raml
                    example: !include /examples/response/error-404.json
              500:
                body:
                  application/json:
                    type: !include /datatypes/response/error.raml
                    example: !include /examples/response/error-500.json
  /debts:
      get:
        is: [security_client_id,tibcoHeaders]
        displayName: Consulta Deudas Cliente
        description: Check items billed on an invoice (adjustments, payments, reconnection, suspension); receive invoice data and return details.
        queryParameters:
            ORIGIN:
              type: string
              example: "WHATSAPP"
              description: Parameter that allows the origin of the request to be identified
            CUSTOMER_ID:
              type: string
              example: "12552454"
              description: Customer identification number can be ID card or tax ID number
              required: false
            CUSTOMER_ID_TYPE:
              type: string
              enum: ["CC","CE","PASAPORTE","NIT","RUT","TI"]
              example: "CC"
              description: Type of customer identification document
              required: false
            BILLING_ACCOUNT:
              type: string
              description: User billing account to retrieve debts
              required: false
            BILLING_NUMBER:
              type: string
              description: User billing Number to retrieve debts
              required: false
            CONNECTION_NUMBER:
              type: number
              description: User phone number
              required: false
        responses:
          200:
            body:
              application/json:
                type: !include /datatypes/response/get-debts.raml
                example: !include /examples/response/get-debts.json
          400:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-400.json
          401:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-401.json
          404:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-404.json
          500:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-500.json
/riskManagement:
  get:
    is: [security_client_id,tibcoHeaders]
    displayName: risk
    description: Valida si un cliente existe en listas negras MECNA; recibe datos de cliente y retorna resultado de validación.
    queryParameters:
        ORIGIN:
          type: string
          example: "WHATSAPP"
          description: Parameter that allows the origin of the request to be identified
        CUSTOMER_ID:
          type: string
          example: "12552454"
          description: Customer identification number can be ID card or tax ID number
          required: false
        CUSTOMER_ID_TYPE:
          type: string
          enum: ["CC","CE","PASAPORTE","NIT","RUT","TI"]
          example: "CC"
          description: Type of customer identification document
          required: false
        ORDER_NUMBER:
          type: string
          example: "MDM"
          description: Order number
          required: false
    responses:
          200:
            body:
              application/json:
                type: !include /datatypes/response/get-risk-management.raml
                example: !include /examples/response/get-risk-management.json
          400:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-400.json
          401:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-401.json
          404:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-404.json
          500:
            body:
              application/json:
                type: !include /datatypes/response/error.raml
                example: !include /examples/response/error-500.json    