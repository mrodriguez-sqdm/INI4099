<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<sub-flow name="get-serviceProblem-pqrs-orchestratorSub_Flow" doc:id="95b51051-9d83-43d9-8330-0c7ef76565a3" >
		<set-variable value="#[attributes.uriParams.'id']" doc:name="Set Number PQR" doc:id="5fe3e5d9-0a4e-4398-9356-e1fa08357553" variableName="numero_pqr" />
		<flow-ref doc:name="call find PQR" doc:id="e50d7501-e2bf-4110-af0f-bbdb68805e47" name="patch-serviceProblem-pqrs-find-clientSub_Flow" />
		<choice doc:name="validate find PQR" doc:id="c7ceeabb-6445-433d-a293-7b43a05589d3" >
			<when expression="#[payload == null]" >
				<set-variable value="404" doc:name="Set Status Code" doc:id="c1aabab3-5d50-49b2-a68c-5412eaf7d2b5" variableName="httpStatus" />
				<ee:transform doc:name="Set Payload" doc:id="c1c1988f-be86-4a38-baf1-ac8ceb0ec173" >
					<ee:message >
						<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
    "status": 404,
    "code": "NOT_DATA_FOUND",
    "message": {
        "message": "Not PQRS were found for this id"
    }
}]]></ee:set-payload>
					</ee:message>
				</ee:transform>
			</when>
			<otherwise >
				<ee:transform doc:name="Set Payload" doc:id="19ce902f-2b75-421d-9a8a-69c5d66a5245" >
					<ee:message >
						<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
payload]]></ee:set-payload>
					</ee:message>
				</ee:transform>
			</otherwise>
		</choice>
	</sub-flow>
</mule>
