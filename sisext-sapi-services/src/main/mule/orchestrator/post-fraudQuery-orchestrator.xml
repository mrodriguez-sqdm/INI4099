<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<sub-flow name="post-fraudQuery-orchestratorSub_Flow" doc:id="63dacfda-4428-4e6e-9cdc-29c95b668a08" >
		<ee:transform doc:name="Set request body" doc:id="27f7558c-352d-43b5-9c39-0b9408e4572c" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/xml
---
{
    "soapenv:Envelope" @(
    'xmlns:soapenv':"http://schemas.xmlsoap.org/soap/envelope/",
    'xmlns:fra':"Fraude_DWH"
    ): {
        "soapenv:Header": null,
        "soapenv:Body":{
            "fra:ConsultaFraude": 
                if(payload.TipoDocumento != null and payload.NumeroDocumento != null) {
                    "fra:TipoDocumento": payload.TipoDocumento,
                    "fra:NumeroDocumento": payload.NumeroDocumento
                } else if(payload.TipoDocumento != null) {
                    "fra:TipoDocumento": payload.TipoDocumento
                } else if(payload.NumeroDocumento != null) {
                    "fra:NumeroDocumento": payload.NumeroDocumento
                } else null
        }
    }
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<flow-ref doc:name="Go to client" doc:id="bdc9a9c9-04b5-4478-996e-8dcc544a48ce" name="post-fraudQuery-clientSub_Flow"/>
		<ee:transform doc:name="Set response" doc:id="dba6588c-3782-434d-b14e-cbeee0741a3b" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
    ConsultaFraudeResponse: {
        ConsultaFraudeResult: {
            Respuesta: if(payload.Envelope.Body.ConsultaFraudeResponse.ConsultaFraudeResult.Respuesta == null) "" else payload.Envelope.Body.ConsultaFraudeResponse.ConsultaFraudeResult.Respuesta,
            Modalidad: if(payload.Envelope.Body.ConsultaFraudeResponse.ConsultaFraudeResult.Modalidad == null) "" else payload.Envelope.Body.ConsultaFraudeResponse.ConsultaFraudeResult.Modalidad,
            FechaRegistro: if(payload.Envelope.Body.ConsultaFraudeResponse.ConsultaFraudeResult.FechaRegistro == null) "" else payload.Envelope.Body.ConsultaFraudeResponse.ConsultaFraudeResult.FechaRegistro
        }
    }
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
	</sub-flow>
</mule>
