<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:file="http://www.mulesoft.org/schema/mule/file" xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/file http://www.mulesoft.org/schema/mule/file/current/mule-file.xsd">
	<sub-flow name="post-getInvoice-orchestratorSub_Flow" doc:id="63dacfda-4428-4e6e-9cdc-29c95b668a08" >
		<ee:transform doc:name="Set request body" doc:id="27f7558c-352d-43b5-9c39-0b9408e4572c" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/xml
---
{
    "soapenv:Envelope" @(
    'xmlns:soapenv':"http://schemas.xmlsoap.org/soap/envelope/",
    'xmlns:etb':"http://doxETB1.etb.com.co/pub/etb"
    ): {
        "soapenv:Header": null,
        "soapenv:Body":{
            "etb:ReciboPagoEmp": 
            {
                "EntReciboPagoEmp" 
                    @(
                        "NomCli": payload.NomCli,
                        "CelCli": payload.CelCli,
                        "Factura": payload.Factura,
                        "FechFact": payload.FechFact,
                        "Pin1": payload.Pin1,
                        "Pin2": payload.Pin2,
                        "Valor": payload.Valor,
                        "ValorIva": payload.ValorIva,
                        "ValorTotal": payload.ValorTotal,
                        "Detalle": payload.Detalle,
                        "Imei": payload.Imei,
                        "DetVal": payload.DetVal,
                        "DetIva": payload.DetIva,
                        "DetValTotal": payload.DetValTotal
                    )
                : null
            }
        }
    }
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
		<flow-ref doc:name="Go to client" doc:id="bdc9a9c9-04b5-4478-996e-8dcc544a48ce" name="post-getInvoice-clientSub_Flow"/>
		<ee:transform doc:name="Set response" doc:id="8c42fb43-ef97-4720-8605-02370c5b28ba" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
    nombArchivo: payload.Envelope.Body.ReciboPagoEmpResponse.return.@nombArchivo,
    tipoArchivo: payload.Envelope.Body.ReciboPagoEmpResponse.return.@tipoArchivo,
    tamaArchivo: payload.Envelope.Body.ReciboPagoEmpResponse.return.@tamaArchivo,
	return: payload.Envelope.Body.ReciboPagoEmpResponse.return.@return
}]]></ee:set-payload>
			</ee:message>
		</ee:transform>
	</sub-flow>
</mule>
