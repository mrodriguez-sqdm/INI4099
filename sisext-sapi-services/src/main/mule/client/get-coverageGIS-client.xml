<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:http="http://www.mulesoft.org/schema/mule/http"
	xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<sub-flow name="get-coverageGIS-clientSub_Flow" doc:id="99139bfa-efed-4c82-91b6-30805e0b1c12" >
		<try doc:name="Try" doc:id="b34f50db-3693-4301-a665-c66106351c1a" >
			<async doc:name="Async" doc:id="e7d20491-c6ad-4694-b771-f505a589f0c3">
					<flow-ref doc:name="Call Logger" doc:id="d96aed36-34d8-460f-9a80-1900d6591197" name="loggin-client-call" />
				</async>
			<http:request method="POST" doc:name="Call Soap wsCoverageGIS" doc:id="5769f8df-1b3f-4852-86c1-0ddcf87f6ba2" config-ref="wsCoverageGIS" path="${wsCoverageGIS.path}">
			<http:headers><![CDATA[#[output application/java
---
{
	"Action" : "http://www.etb.net.co/svc/WsGetFactibilidadServiciosPortType/getFactibilidadServiciosRequest",
	"Content-Type" : "application/soap+xml"
}]]]></http:headers>
		</http:request>
			<async doc:name="Async" doc:id="aba03220-7014-47a9-8931-611cb40e7cf0" >
				<flow-ref doc:name="Call Logger" doc:id="a39cad60-f018-4cd3-b692-051c80e69016" name="loggin-client-call" />
			</async>
			<error-handler >
				<on-error-continue enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="4d8fe562-4df0-4285-be25-b3cb51c05077" >
					<ee:transform doc:name="Error Description" doc:id="7d985692-851c-4263-84dd-b390761a3766" >
						<ee:message >
						</ee:message>
						<ee:variables >
							<ee:set-variable variableName="errorDesc" ><![CDATA[%dw 2.0
output application/json
---
{
  "wsGetFactibilidadServicios-RS":{    
    "GisRespuestaProceso":{
     "CodigoRespuesta": "FAIL",
     "CodigoError": "COVGISERR01",
     "DescripcionError": error.errorMessage.payload.Envelope.Body.Fault.Reason.Text
    }
  }
}]]></ee:set-variable>
						</ee:variables>
					</ee:transform>
				</on-error-continue>
			</error-handler>
		</try>
		<logger level="INFO" doc:name="Logger" doc:id="0fa81684-3ddb-4c9b-acf5-fee5c338fddb" message="#[payload]"/>
	</sub-flow>
</mule>
