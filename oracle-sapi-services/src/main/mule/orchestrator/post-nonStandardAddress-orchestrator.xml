<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:validation="http://www.mulesoft.org/schema/mule/validation" xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/validation http://www.mulesoft.org/schema/mule/validation/current/mule-validation.xsd">
	<sub-flow name="post-nonStandardAddress-orchestratorSub_Flow" doc:id="b456b45e-6051-4f2d-8fc9-8490876265a6" >
		<flow-ref doc:name="Get direccion" doc:id="01c9da9b-9663-4f84-9263-e5cda20bbf1a" name="get-nonStandardAddressById-client"/>
		<choice doc:name="Check If Exists" doc:id="f5e6a2eb-0de6-4169-a61f-e108aece4b58" >
			<when expression="#[payload[0].DIRECCION == null]">
				<flow-ref doc:name="Insert New Direccion" doc:id="ea7751e3-454f-41d7-b8e5-304741498051" name="post-nonStandardAddress-client" />
				<ee:transform doc:name="Output" doc:id="3c5a0103-8f2f-442f-b2f9-a7ac7a4b42cb" >
					<ee:message >
						<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
  "outputSet": {
    "RETURN_VALUE": vars.address
  }
}]]></ee:set-payload>
					</ee:message>
				</ee:transform>
			</when>
			<otherwise >
				<raise-error doc:name="Raise error" doc:id="86cc6874-627b-4a72-bd6c-a14a5df28ff6" type="VALIDATION" description='#["Address " ++ vars.address ++ " already exists in Oracle"]'/>
			</otherwise>
		</choice>
		<async doc:name="Async" doc:id="ba9fe886-fd1b-4e5d-9d30-e36aef5b98cc">
					<flow-ref doc:name="Call logger after" doc:id="8bc2c52f-2747-4a2a-b588-11eee99af089" name="loggin-client-call" />
				</async>
	</sub-flow>
</mule>
