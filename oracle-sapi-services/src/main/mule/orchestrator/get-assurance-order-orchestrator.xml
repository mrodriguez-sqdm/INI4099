<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<sub-flow name="get-assurance-order-orchestratorSub_Flow" doc:id="b7c84116-7858-46b9-8001-9c613d6f7e29" >
		<set-variable value="#[p('mongo-sapi-services.parameters.param')]" doc:name="typeParameter" doc:id="348f0648-391c-46fb-b83f-46affcd54241" variableName="typeParameter"/>
		<flow-ref doc:name="Obtain Parameters" doc:id="8cf122a5-4841-45f8-a718-fb442706e206" name="get-parameters"/>
		<ee:transform doc:name="authString" doc:id="5add94db-32e1-4497-9a9c-6473979da732" >
			<ee:message >
			</ee:message>
			<ee:variables >
				<ee:set-variable variableName="authString" ><![CDATA[%dw 2.0
import * from dw::core::Binaries
output application/json
var user = (payload[0].Valores filter $.Codigo == p('oracle-ocs.syncOrder.user'))[0].Nombre
var company = (payload[0].Valores filter $.Codigo == p('oracle-ocs.syncOrder.company'))[0].Nombre
var pass = (payload[0].Valores filter $.Codigo == p('oracle-ocs.syncOrder.pass'))[0].Nombre
---
toBase64((user ++ "@" ++ company ++ ":" ++ pass) as Binary)]]></ee:set-variable>
			</ee:variables>
		</ee:transform>
		<flow-ref doc:name="Go to Client" doc:id="fad43eec-e8a2-4f6d-a7ad-77bdf1fe4029" name="get-assurance-order-clientSub_Flow"/>
		<ee:transform doc:name="Map Out" doc:id="85f4114f-e8ef-4213-b324-4c0e96bce9d3" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
payload]]></ee:set-payload>
			</ee:message>
		</ee:transform>
	</sub-flow>
</mule>
