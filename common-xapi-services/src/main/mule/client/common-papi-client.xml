<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
	<sub-flow name="get-geographicAddress-operation-clientSub_Flow" doc:id="747a8e9d-aeca-47ab-bc31-d6cac2739997" >
		<http:request method="GET" doc:name="get-geographicAddress-operation-client" doc:id="b7620a1e-ceba-411b-81cc-e62a95a1c0a5" config-ref="common_papi_config" path="${common-papi.path.geoAddress}">
			<http:headers ><![CDATA[#[%dw 2.0
output application/java
var headers = attributes.headers
var correlationIdValue = if (headers."x-correlation-id" != null and headers."x-correlation-id" != "") 
	headers."x-correlation-id" 
else 
	uuid()
---
{  
	"Content-Type": "application/json",
  	"Accept": "application/json",
	"client_secret" : p('common-papi.client_secret'),
	"client_id" : p('common-papi.client_id'),
	"systemId" : "MIGRACION",
	"X-CORRELATION-ID": correlationIdValue
} ++ (if (headers.name != null and headers.name != "") {"name": headers.name} else {})
  ++ (if (headers.source != null and headers.source != "") {"source": headers.source} else {})
  ++ (if (headers.system_Id != null and headers.system_Id != "") {"system_Id": headers.system_Id} else {})]]]></http:headers>
			<http:query-params ><![CDATA[#[%dw 2.0
output application/java
var qs = attributes.queryParams
---
{
	"address": qs.address,
	"cityId": qs.cityId
} ++ (if (qs.limit != null and qs.limit != "") {"limit": qs.limit} else {})]]]></http:query-params>
		</http:request>
	</sub-flow>
	
	<sub-flow name="get-coverage-clientSub_Flow" doc:id="coverage-client-subflow" >
		<http:request method="GET" doc:name="get-coverage-client" doc:id="coverage-client-request" config-ref="common_papi_config" path="${common-papi.path.coverage}">
			<http:headers ><![CDATA[#[%dw 2.0
output application/java
var headers = attributes.headers
var correlationIdValue = if (headers."x-correlation-id" != null and headers."x-correlation-id" != "") 
	headers."x-correlation-id" 
else 
	uuid()
---
{  
	"Content-Type": "application/json",
  	"Accept": "application/json",
	"client_secret" : p('common-papi.client_secret'),
	"client_id" : p('common-papi.client_id'),
	"systemId" : "MIGRACION",
	"X-CORRELATION-ID": correlationIdValue
} ++ (if (headers.name != null and headers.name != "") {"name": headers.name} else {})
  ++ (if (headers.source != null and headers.source != "") {"source": headers.source} else {})
  ++ (if (headers.system_Id != null and headers.system_Id != "") {"system_Id": headers.system_Id} else {})]]]></http:headers>
			<http:query-params ><![CDATA[#[%dw 2.0
output application/java
var qs = attributes.queryParams
---
{
	"latitude": qs.latitude,
	"longitude": qs.longitude
}]]]></http:query-params>
		</http:request>
	</sub-flow>
	<sub-flow name="get-geocodificar-clientSub_Flow" doc:id="geocodificar-client-subflow" >
		<http:request method="GET" doc:name="get-geocodificar-client" doc:id="geocodificar-client-request" config-ref="common_papi_config" path="${common-papi.path.geocodificar}">
			<http:headers ><![CDATA[#[%dw 2.0
output application/java
var headers = attributes.headers
var correlationIdValue = if (headers."x-correlation-id" != null and headers."x-correlation-id" != "") 
	headers."x-correlation-id" 
else 
	uuid()
---
{  
	"Content-Type": "application/json",
  	"Accept": "application/json",
	"client_secret" : p('common-papi.client_secret'),
	"client_id" : p('common-papi.client_id'),
	"systemId" : "MIGRACION",
	"X-CORRELATION-ID": correlationIdValue
} ++ (if (headers.name != null and headers.name != "") {"name": headers.name} else {})
  ++ (if (headers.source != null and headers.source != "") {"source": headers.source} else {})
  ++ (if (headers.system_Id != null and headers.system_Id != "") {"system_Id": headers.system_Id} else {})]]]></http:headers>
			<http:query-params ><![CDATA[#[%dw 2.0
output application/java
var qs = attributes.queryParams
---
{
	"address": qs.address
}]]]></http:query-params>
		</http:request>
	</sub-flow>
	<sub-flow name="get-georeference-common-papi-clientSub_Flow" doc:id="georeference-common-papi-client-subflow" >
		<http:request method="GET" doc:name="get-georeference-client" doc:id="georeference-common-papi-client-request" config-ref="common_papi_config" path="/geographicAddressManagement/v1/geographicAddress/georeference">
			<http:headers ><![CDATA[#[%dw 2.0
output application/java
var headers = attributes.headers
var correlationIdValue = if (headers."x-correlation-id" != null and headers."x-correlation-id" != "") 
	headers."x-correlation-id" 
else 
	uuid()
---
{  
	"Content-Type": "application/json",
  	"Accept": "application/json",
	"client_secret" : p('common-papi.client_secret'),
	"client_id" : p('common-papi.client_id'),
	"systemId" : "MIGRACION",
	"X-CORRELATION-ID": correlationIdValue
} ++ (if (headers.name != null and headers.name != "") {"name": headers.name} else {})
  ++ (if (headers.source != null and headers.source != "") {"source": headers.source} else {})
  ++ (if (headers.system_Id != null and headers.system_Id != "") {"system_Id": headers.system_Id} else {})]]]></http:headers>
			<http:query-params ><![CDATA[#[%dw 2.0
output application/java
var qs = attributes.queryParams
---
{
	"address": qs.address,
	"municipioCode": qs.municipalityCod default "",
	"departamentoCode": qs.departamentCod default ""
}]]]></http:query-params>
		</http:request>
	</sub-flow>
</mule>
