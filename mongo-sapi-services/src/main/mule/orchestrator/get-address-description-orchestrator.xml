<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<sub-flow name="get-address-description-orchestrator" doc:id="62083247-25ef-497a-80e6-80e60d917aad" >
		<choice doc:name="Choice" doc:id="bec9b257-10ac-4074-accc-9a04d7d5bc34" >
			<when expression="#[vars.cityId != null]">
				<flow-ref doc:name="get-address-description-department" doc:id="0ab2689b-511c-45b2-b35c-2faffb2b92ae" name="get-address-description-department" />
				<flow-ref doc:name="get-address-description-city" doc:id="1cfc9ad5-565f-4b94-aa08-bb0c8d35e6ee" name="get-address-description-city" target="cityDesc" targetValue="#[payload.city.description]"/>
				<ee:transform doc:name="Transform Message" doc:id="1b9c9178-0d0d-4ecd-b156-e8cb8bed5551">
							<ee:message>
								<ee:set-payload><![CDATA[%dw 2.0
output application/json
//var departmentPayload=Mule::lookup('get-address-description-department',{})
//var cityPayload=Mule::lookup('get-address-description-city',{})
---
payload ++
city: {
    id: vars.cityId,
    description:vars.cityDesc
}]]></ee:set-payload>
							</ee:message>
						</ee:transform>
			</when>
			<otherwise >
				<flow-ref doc:name="get-address-description-department" doc:id="9ff5630e-0153-40fd-9375-62cc452a7c2e" name="get-address-description-department"/>
			</otherwise>
		</choice>
	</sub-flow>
</mule>
