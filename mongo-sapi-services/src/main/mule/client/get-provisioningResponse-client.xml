<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:mongo="http://www.mulesoft.org/schema/mule/mongo" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/mongo http://www.mulesoft.org/schema/mule/mongo/current/mule-mongo.xsd">
	<sub-flow name="get-provisioningResponse-clientSub_Flow" doc:id="f974a53b-9919-4d1b-ae2b-c349141415d2" >
		<async doc:name="Async" doc:id="b58d5eb2-129a-458c-85de-0bc6b867d8a1" >
			<flow-ref doc:name="Call logger before" doc:id="0c709cad-54ea-4dda-9957-0067d3b62af7" name="loggin-client-call"/>
		</async>
		<choice doc:name="Choice" doc:id="5c8c5518-b34a-4ad3-93cc-dd9a346d3d3f" >
			<when expression="#[vars.identificador != null]">
				<mongo:find-documents collectionName="${mongoDb.collectionRtaProvisioning}" fields="," doc:name="Obtain provisioning response by his orderOM and identificador" doc:id="1e57e99e-4bdd-474a-a908-b4fc95ac5492" config-ref="or_db_config">
			<mongo:query><![CDATA[#[%dw 2.0
output application/json
---
{ 
	'ordenOM': vars.ordenOm,
	'identificador': vars.identificador
	
}]]]></mongo:query>
		</mongo:find-documents>
			</when>
			<otherwise >
				<mongo:find-documents collectionName="${mongoDb.collectionRtaProvisioning}" fields="," doc:name="Obtain provisioning response by his orderOM" doc:id="6372b7e3-99f8-467e-9a6b-dc6c4563f36c" config-ref="or_db_config" >
					<mongo:query ><![CDATA[#[%dw 2.0
output application/json
---
{ 
	'ordenOM': vars.ordenOm	
}]]]></mongo:query>
				</mongo:find-documents>
			</otherwise>
		</choice>
		<async doc:name="Async" doc:id="a185bc93-70a0-4b5a-83be-547fe083954e" >
			<flow-ref doc:name="Call logger after" doc:id="3355e8db-a6cd-405d-ac33-bf57a789cc55" name="loggin-client-call"/>
		</async>
	</sub-flow>
</mule>
