<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:mongo="http://www.mulesoft.org/schema/mule/mongo"
	xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/mongo http://www.mulesoft.org/schema/mule/mongo/current/mule-mongo.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<sub-flow name="get-billingAccounts-clientSub_Flow" doc:id="920d14c4-8367-42e6-adcd-dafade854d55" >
		<async doc:name="Async" doc:id="257ea537-6295-436d-9924-a9c820d29d4d">
			<flow-ref doc:name="Call logger before" doc:id="4e4c80a9-f4d9-45f4-a262-af63cdee05b1" name="loggin-client-call" />
		</async>
		<ee:transform doc:name="Set Query" doc:id="e9a7e722-6447-4fc7-a11e-cc53275719e5" >
			<ee:message >
			</ee:message>
			<ee:variables >
				<ee:set-variable variableName="query" ><![CDATA[output application/json
---
{
    "Tipo_Documento":  vars.tipoDocumento,
    "Numero_Identificacion": vars.numeroIdentificacion
}]]></ee:set-variable>
			</ee:variables>
		</ee:transform>
		<mongo:find-documents doc:name="Obtain list of Billing Accounts by his document's type and document" doc:id="207b27d0-d00c-49c6-af69-269f99fe9ac5" config-ref="mdm_db_Config" collectionName="#[p('mongoDb-mdm.tibco.collection-ctaFact')]" fields=",">
			<mongo:query ><![CDATA[#[vars.query]]]></mongo:query>
		</mongo:find-documents>
		<async doc:name="Async" doc:id="7ff1bdc4-d88c-435b-aa6f-95796bc2a80b" >
			<flow-ref doc:name="Call logger after" doc:id="858fbe54-2d2c-4892-b683-aa419a1dec33" name="loggin-client-call" />
		</async>
	</sub-flow>
</mule>
