<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:mongo="http://www.mulesoft.org/schema/mule/mongo" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/mongo http://www.mulesoft.org/schema/mule/mongo/current/mule-mongo.xsd">
	<sub-flow name="get-servicesbyDoc-clientSub_Flow" doc:id="b8c2129b-98d5-4460-ba09-181095913507" >
		<choice doc:name="Choice" doc:id="6333dc27-a21a-4106-bfac-580b0c75efed" >
			<when expression='#[vars.logs == "mongo"]'>
				<async doc:name="Async" doc:id="72ec8365-940d-47ce-9fff-3368ba73b483" >
					<flow-ref doc:name="Call logger before audits-mongo" doc:id="497362c5-4900-4c60-b11d-a55a668d4a2e" name="audits-mongo-log-before" />
				</async>
			</when>
			<otherwise >
				<async doc:name="Async" doc:id="ba99f9e9-b52f-47ca-89ce-23fcb52c950f">
			<flow-ref doc:name="Call logger before" doc:id="f4d4800e-e286-42f7-bf17-a2a434b7a8e5" name="loggin-client-call" />
		</async>
			</otherwise>
		</choice>
		<choice doc:name="Choice" doc:id="0884739f-be48-43ff-a666-8235048c6ecd" >
			<when expression='#[vars.activo == "Y"]'>
				<mongo:find-documents collectionName="${mongoDb-mdm.mayoristas.collection-rneMoviles}" fields="," doc:name="Get active services" doc:id="caba2619-2c5f-4c59-9948-9d22483891c7" config-ref="mdm_db_Config" >
					<mongo:query ><![CDATA[#["{'Tipo_Documento': '" ++ vars.tipoDoc ++ "', 'Numero_Identificacion': '" ++ vars.numDoc ++ "'}"]]]></mongo:query>
				</mongo:find-documents>
			</when>
			<otherwise >
				<mongo:find-documents collectionName="${mongoDb-mdm.mayoristas.collection-services}" fields="," doc:name="Get services" doc:id="e9a02f33-023b-41b3-985e-62a0a023637c" config-ref="mdm_db_Config">
			<mongo:query><![CDATA[#["{'Cliente.Tipo_Documento': '" ++ vars.tipoDoc ++ "', 'Cliente.Numero_Documento': '" ++ vars.numDoc ++ "'}"]]]></mongo:query>
		</mongo:find-documents>
			</otherwise>
		</choice>
		<choice doc:name="Choice1" doc:id="04337c2d-3b8a-4ba6-9000-f3c362a081ec" >
			<when expression='#[vars.logs == "mongo"]' >
				<async doc:name="Async" doc:id="bd598d0e-2460-4393-a713-f50bbb6ca77a">
					<flow-ref doc:name="Call logger after audits-mongo" doc:id="cf55fd95-4d2f-4292-8ee6-acb9f0270821" name="audits-mongo-log-after" />
				</async>
			</when>
			<otherwise>
				<async doc:name="Async" doc:id="d638fa8d-5783-4d92-8e96-cd6ee8b69505">
			<flow-ref doc:name="Call logger after" doc:id="b383df29-f4ec-44dc-a664-4e52e4bf6b1f" name="loggin-client-call" />
		</async>
			</otherwise>
		</choice>
	</sub-flow>
</mule>
