<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:mongo="http://www.mulesoft.org/schema/mule/mongo"
	xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/mongo http://www.mulesoft.org/schema/mule/mongo/current/mule-mongo.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<sub-flow name="get-typeParameter-client" doc:id="0fbf513c-3735-4e22-bf11-6e6520412810" >
		<choice doc:name="Choice" doc:id="ecfbc3ac-f043-42a7-b532-84ca36333289" >
			<when expression='#[vars.logs == "mongo"]'>
				<async doc:name="Async" doc:id="3ba918f4-5b6a-4a83-96da-69ac5bed2941" >
					<flow-ref doc:name="Call logger before" doc:id="e11edeab-11c3-4af4-9839-fa63252d9765" name="audits-mongo-log-before" />
				</async>
			</when>
			<otherwise >
				<async doc:name="Async" doc:id="53c841e0-f49a-4ef1-8051-02429d6953c9">
			<flow-ref doc:name="Call logger before" doc:id="c6bc9796-9e1a-41cf-951a-e112e2325069" name="loggin-client-call" />
		</async>
			</otherwise>
		</choice>
		<mongo:find-documents doc:name="get parameters by type" doc:id="3fa40288-87b3-4f19-b110-f0b0adb92111" config-ref="mdm_db_Config" fields="," collectionName="#[p('mongoDb-mdm.mayoristas.collection-parameter')]">
			<mongo:query ><![CDATA[#["{ 'Tipo_Parametro': '" ++ attributes.uriParams.typeParameter ++ "'}"]]]></mongo:query>
		</mongo:find-documents>
		<choice doc:name="Choice" doc:id="7a4b2460-f57b-465f-acc4-54203eaddeb7">
			<when expression='#[vars.logs == "mongo"]' >
				<async doc:name="Async" doc:id="fd09215c-df91-47de-a7ac-98ad198e0fec" >
					<flow-ref doc:name="Call logger after" doc:id="4cf71121-6ce6-4a8b-9067-38cdb2414511" name="audits-mongo-log-after" />
				</async>
			</when>
			<otherwise >
				<async doc:name="Async" doc:id="2d1f00a0-378a-4da4-adb5-baf82795065e">
			<flow-ref doc:name="Call logger after" doc:id="297cbd41-0565-4afc-abaf-36cd95d9cd9b" name="loggin-client-call" />
		</async>
			</otherwise>
		</choice>
		<ee:transform doc:name="Transform Message" doc:id="23835a67-37ba-4d70-b08f-1e6d1a37b25a" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
payload]]></ee:set-payload>
			</ee:message>
		</ee:transform>
	</sub-flow>
</mule>
