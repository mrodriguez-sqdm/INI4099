<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:mongo="http://www.mulesoft.org/schema/mule/mongo" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/mongo http://www.mulesoft.org/schema/mule/mongo/current/mule-mongo.xsd">
	<sub-flow name="patch-referred-client" doc:id="ed472f9f-c7eb-4a31-bd3d-6d09047cd520" >
		<async doc:name="Async" doc:id="46a33fbc-f113-42d9-ac8b-3944cf91695a" >
			<flow-ref doc:name="Call logger before" doc:id="bb19afe6-7c38-4277-9b13-76240f16c629" name="audits-mongo-log-before"/>
		</async>
		<mongo:update-documents doc:name="Update documents" doc:id="21d78013-af6e-4e1a-8188-d842dcb2c019" config-ref="mdm_db_Config" collectionName="${mongoDb-mdm.mayoristas.collection-referral}">
			<mongo:query ><![CDATA[#["{'Tipo_Documento_Empleado': '" ++ attributes.queryParams.tipoDocumento ++ "','Numero_Documento_Empleado': '" ++ attributes.queryParams.numeroIdentificacion ++ "','Tipo_Documento_Referido': '" ++ attributes.queryParams.tipoDocumentoReferido ++ "','Numero_Documento_Referido': '" ++ attributes.queryParams.numeroDocumentoReferido ++ "'}"]]]></mongo:query>
		</mongo:update-documents>
		<async doc:name="Async" doc:id="e5e6a11c-3c0e-41d9-8c0d-344886014ccb" >
			<flow-ref doc:name="Call logger after" doc:id="0b76d281-421b-49c4-99b5-1d5cf1e8617d" name="audits-mongo-log-after"/>
		</async>
	</sub-flow>
</mule>
