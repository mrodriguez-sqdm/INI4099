<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<sub-flow name="get-disponibilidad-handlerSub_Flow" doc:id="ba60f355-e765-478e-a41f-5a44fbe8376d" >
		<ee:transform doc:name="queryParams" doc:id="7521727c-92b8-466c-82cc-c3800b9e4284" >
			<ee:message >
			</ee:message>
			<ee:variables >
				<ee:set-variable variableName="msisdn" ><![CDATA[%dw 2.0
output application/java
---
attributes.queryParams.msisdn]]></ee:set-variable>
				<ee:set-variable variableName="sim" ><![CDATA[%dw 2.0
output application/java
---
attributes.queryParams.sim]]></ee:set-variable>
				<ee:set-variable variableName="Subtipo_Orden" ><![CDATA[%dw 2.0
output application/java
---
attributes.queryParams.Subtipo_Orden]]></ee:set-variable>
			</ee:variables>
		</ee:transform>
		<choice doc:name="Choice" doc:id="9d98c4ed-9083-48bd-a821-7d871ecb0e97" >
			<when expression="#[vars.sim == null and vars.msisdn == null]">
				<ee:transform doc:name="Response notFound" doc:id="719ba592-ffd4-428b-a618-fa086c1b7f23" >
					<ee:message >
						<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
{
  "status": 404,
  "code": "NOT_FOUND",
  "message": {
    "message": "Data not found"
  },
  "messageServer": "Sim y mssidn no deben ir vacios",
  "cause": [
    {
      "origin": app.name,
      "message": "org.mule.extension.http.api.exception.NotFoundExcecption"
    }
  ]
}]]></ee:set-payload>
					</ee:message>
					<ee:variables >
						<ee:set-variable variableName="httpStatus" ><![CDATA[%dw 2.0
output application/java
---
404]]></ee:set-variable>
					</ee:variables>
				</ee:transform>
			</when>
			<otherwise >
				<flow-ref doc:name="Go to orchestrator" doc:id="0b8bae95-b19c-498a-addf-23941d2780c3" name="get-disponibilidad-orchestratorSub_Flow" />
			</otherwise>
		</choice>
	</sub-flow>
</mule>
