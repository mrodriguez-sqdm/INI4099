<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:etbutilities="http://www.mulesoft.org/schema/mule/etbutilities" xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/etbutilities http://www.mulesoft.org/schema/mule/etbutilities/current/mule-etbutilities.xsd">
	<sub-flow name="post-servicios-svas-handlerSub_Flow" doc:id="de1739b6-cf73-4026-9f44-6a5356ae7ba2" >
		<set-variable value="#[attributes.headers]" doc:name="Set initial headers" doc:id="9dfba838-da81-4dba-b920-1d847c5a468e" variableName="headers" />
		<async doc:name="Async" doc:id="1f792ada-fd2f-4538-9071-704891da6755">
					<ee:transform doc:name="Map Log Body" doc:id="670da250-4808-4869-9bc6-6f7a3aa606f9">
						<ee:message>
							<ee:set-payload><![CDATA[output application/json
---
{
	correlationId: correlationId,
	(path: attributes.requestUri) if(!isEmpty(attributes.requestUri)),
	(uriParams: attributes.uriParams) if (!isEmpty(attributes.uriParams)),
	(queryParams: attributes.queryParams) if (!isEmpty(attributes.queryParams)),
	(headers: attributes.headers) if (!isEmpty(attributes.headers)),
	(payload: payload) if (!isEmpty(payload))
}]]></ee:set-payload>
						</ee:message>
					</ee:transform>
					<flow-ref doc:name="Call logger before audits-mongo" doc:id="d6fe6087-1416-4fcb-87c7-646a8f51046e" name="audits-mongo-log-before" />
				</async>
		<flow-ref doc:name="Go to orchestrator" doc:id="fe609f76-4b71-4a50-8ce9-fc46782f6715" name="post-servicios-svas-orchestratorSub_Flow" />
	</sub-flow>
</mule>
